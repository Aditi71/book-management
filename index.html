<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="style.css">
    <title>Book Manager</title>
</head>
<body>
  <h1>Add a New Book</h1>
  <form id="bookForm">
    <label>Title:</label>
    <input type="text" id="title" required><br><br>

    <label>Author:</label>
    <input type="text" id="author" required><br><br>

    <button type="submit">Add Book</button>
  </form>

  <h1>Update a Book</h1>
  <form id="updateForm">
    <label>Book ID:</label>
    <input type="number" id="updateId" required><br><br>

    <label>New Title:</label>
    <input type="text" id="updateTitle"><br><br>

    <label>New Author:</label>
    <input type="text" id="updateAuthor"><br><br>

    <button type="submit">Update Book</button>
  </form>

  <h2>Book List</h2>
  <ul id="bookList"></ul>

  <script>
    // Fetch all books when page loads
    function loadBooks() {
      fetch('/books')
        .then(res => res.json())
        .then(data => {
          const list = document.getElementById('bookList');
          list.innerHTML = '';
          data.forEach(book => {
            const li = document.createElement('li');
            li.textContent = `${book.id}: ${book.title} by ${book.author} `;
            
            // Delete button
            const delBtn = document.createElement('button');
            delBtn.textContent = "Delete";
            delBtn.onclick = () => deleteBook(book.id);
            li.appendChild(delBtn);

            list.appendChild(li);
          });
        });
    }

    // Add a new book (POST)
    document.getElementById('bookForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const title = document.getElementById('title').value;
      const author = document.getElementById('author').value;

      fetch('/books', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, author })
      })
      .then(res => res.json())
      .then(() => {
        loadBooks();
        document.getElementById('bookForm').reset();
      });
    });

    // Update a book (PUT)
    document.getElementById('updateForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const id = document.getElementById('updateId').value;
      const title = document.getElementById('updateTitle').value;
      const author = document.getElementById('updateAuthor').value;

      fetch(`/books/${id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, author })
      })
      .then(res => res.json())
      .then(() => {
        loadBooks();
        document.getElementById('updateForm').reset();
      });
    });

    // Delete a book (DELETE)
    function deleteBook(id) {
      fetch(`/books/${id}`, { method: 'DELETE' })
        .then(res => res.json())
        .then(() => {
          loadBooks();
        });
    }

    // Load books initially
    loadBooks();
  </script>
</body>
</html>
